<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta name="color-scheme" content="light dark">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Анонимный чат</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        tg: {
                            bg: 'var(--tg-theme-bg-color, #ffffff)',
                            text: 'var(--tg-theme-text-color, #000000)',
                            hint: 'var(--tg-theme-hint-color, #999999)',
                            link: 'var(--tg-theme-link-color, #2481cc)',
                            button: 'var(--tg-theme-button-color, #2481cc)',
                            buttonText: 'var(--tg-theme-button-text-color, #ffffff)',
                            secondary: 'var(--tg-theme-secondary-bg-color, #f1f1f1)'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid var(--tg-theme-bg-color, #ffffff);
            border-bottom-color: var(--tg-theme-button-color, #2481cc);
            border-radius: 50%;
            animation: rotation 1s linear infinite;
        }
        .no-bounce {
            height: 100%;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }
    </style>
</head>
<body class="no-bounce bg-tg-bg text-tg-text">
    <!-- Экран ввода никнейма -->
    <div id="nickname-screen" class="screen fixed inset-0 flex flex-col items-center p-4">
        <div class="text-2xl font-bold text-center py-10">Добро пожаловать в анонимный чат!</div>
        <div class="w-full max-w-md flex flex-col gap-4">
            <input type="text" id="nickname-input" class="w-full p-3 rounded-lg border border-gray-300 bg-tg-bg text-tg-text" placeholder="Введите ваш никнейм...">
            <button id="nickname-submit" class="w-full p-3 rounded-lg bg-tg-button text-tg-buttonText font-medium">Сохранить</button>
            <div id="nickname-error" class="text-red-500 text-center"></div>
        </div>
    </div>
    
    <!-- Экран поиска собеседника -->
    <div id="search-screen" class="screen hidden fixed inset-0 flex flex-col">
        <div class="py-4 px-4 border-b border-gray-200 flex justify-center items-center">
            <div class="text-xl font-bold">Анонимный чат</div>
        </div>
        <div class="flex-1 flex flex-col items-center justify-center p-4">
            <div class="flex flex-col items-center justify-center w-full">
                <button id="random-chat" class="bg-tg-button text-tg-buttonText py-4 px-6 rounded-xl font-bold text-lg shadow-md w-4/5 max-w-xs mb-8 transition-transform active:scale-95">
                    Найти собеседника
                </button>
                
                <!-- Индикатор загрузки и время поиска -->
                <div id="search-loading" class="hidden flex flex-col items-center mt-8 w-4/5 max-w-xs">
                    <div class="loader mb-6"></div>
                    <div class="text-lg font-bold mb-2">Поиск собеседника...</div>
                    <div class="text-tg-hint">Время поиска: <span id="search-timer" class="font-bold">0</span> сек</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Экран чата -->
    <div id="chat-screen" class="screen hidden fixed inset-0 flex flex-col">
        <div class="py-3 px-4 border-b border-gray-200 flex justify-between items-center">
            <button id="find-user" class="bg-tg-button text-tg-buttonText py-1.5 px-3 rounded-md text-sm">Новый чат</button>
            <div class="text-center">Собеседник: <span id="partner" class="font-medium">Ищем...</span></div>
            <button id="end-chat" class="bg-red-500 text-white py-1.5 px-3 rounded-md text-sm">Выход</button>
        </div>
        <div id="message-list" class="flex-1 overflow-y-auto p-4 bg-gray-50"></div>
        <div class="p-3 border-t border-gray-200 flex gap-2 bg-tg-bg">
            <input type="text" id="input-message" class="flex-1 p-2.5 rounded-full border border-gray-300 bg-tg-bg text-tg-text" placeholder="Сообщение...">
            <button id="send-button" class="bg-tg-button text-tg-buttonText p-2.5 rounded-full w-12 h-12 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                </svg>
            </button>
        </div>
    </div>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="/script.js"></script>
</body>
</html> 